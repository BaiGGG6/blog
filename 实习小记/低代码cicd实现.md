# 低代码 CICD 实现思路

## 前言：
- 此篇文章对于k8s云原生是非常依赖的，云原生也是未来的发展方向
- 实习中有在低代码SaaS的组里呆过，遇到低代码集成式的cicd，所以做此总结
- 现在大部分公司都是devops敏捷迭代，一般都是2周一版本，进行迭代发版

## 术语解释：
    
cicd： 持续集成和持续交付 / 部署
    
devops：开发运维结合，提供开发，测试，数据监测，k8s云集成等强大的一系列功能

Kubernetes(k8s)：自动部署、扩缩和管理容器化应用程序，也就是对云资源进行部署编排，例如多云资源(阿里云，腾讯云，aws云...)的整体编排。

pod：k8s中最小的调度管理单位，pod中可以有多个容器

pv：k8s中的数据卷，可以是不同机器的数据卷，类似于docker容器中绑定主机地址和容器内地址.

pvc：k8s中对于pv的申请，就是说明需要多少空间，类型，以及访问模式等

svc：可以为一组pod提供外部访问策略，以及pod层面的负载均衡

ingress: 用于管理对集群内服务的外部访问，一般情况都是基于nginx实现，通过路径路由到不同的svc中

deployment: 用于管理一组资源对象，例如可以动态的控制一组资源对象所构建的pod的数量，实现快速的扩容缩容
## 背景:
此低代码是全栈低代码，也就是前后端都是低代码，并且包括自有一套git分支管理，
能多人协作开发，基于云原生k8s去实现的应用资源发布(包括数据库)，哪这种场景下基于k8s去管控资源，
我们就需要通过一套基于k8s实现的cicd去动态部署我们的发布应用

## 实现思路：
tips：这里面所有的操作，都是通过代码实现的，对于这些pod，k8s是有yaml模板编写可以传入参数，加内置脚本实现对应的逻辑控制，以及通过k8s的数据卷进行文件传递

**CI：**
1. 首先会构建一个带有source-git的容器，将我们传入的版本代码拉取到本地

2. 此时还会构建个带有maven的容器，将git拉下的代码进行package打包

3. 拿到打包后的jar包，再构建带有kaniko的容器，将这jar包打成对应的镜像，将打包后的镜像上传到harbor镜像仓库

**CD:**

4. 根据配置模板在k8s中构建对应的svc

5. 根据配置模板在k8s中构建ingress

6. 根据配置模板在k8s中构建deployment

## 流程图：
![img.png](../imge/实习小记/低代码%20CICD%20实现思路文档/img.png)

## 拓展：
- k8s的功能非常强大，甚至都可以替代掉我们微服务中的网关，并且能够对多云资源进行整合
- 对于k8s中还有服务网格的概念，甚至可以对整条请求链路进行监控，以及流量管理，个人认为这也是未来的一大趋势